---
import Pagination from "../../component/Pagination.astro";
import MainLayout from "../../layouts/MainLayout.astro";
import PostCard from "../../component/PostCard.astro";
import { formatBlogPosts } from '../../js/utils'

export async function getStaticPaths({ paginate }) {
    const allPosts = await Astro.glob("./*.md")
    const formattedPosts = formatBlogPosts(allPosts)

    return paginate(formattedPosts, {
        pageSize: 3,
    })
}

const { page } = Astro.props
---


<MainLayout title="My blof">
    <section class="container" aria-label="New Blog Posts">
        <h1 class="h1">New Blog Posts</h1>
        <div class="post-container">
            {page.data.map((post) =>
                    <PostCard
                            frontmatter={post.frontmatter}
                            url={post.url}
                            tagType="h2"
                    />
            )}
        </div>
    </section>
    <Pagination prevUrl={page.url.prev} nextUrl={page.url.next}/>
</MainLayout>